---
title: internal_port_scanning
description: Detects internal network port scanning from a single source to many destinations.
author: nanos.sh
severity: medium
mode: live
detection_mode: scheduled
schedule: "*/5 * * * *"
lookback: 15m
folder: network
mitre_tactics:
  - TA0007
mitre_techniques:
  - T1046
tags:
  - port_scan
  - network
  - reconnaissance
ai_triage_hints:
  ignore_when:
    - "Known vulnerability scanner (Nessus, Qualys)"
    - "IT performing authorized network scan"
  suspicious_when:
    - "Scanning from workstation, not scanner"
    - "Targeting many ports on single host"
  context: "Port scanning maps available services. From a workstation, this indicates compromise and lateral movement preparation."
---
source_type=firewall OR source_type=network_flow OR source_type=endpoint_edr
| where action="network_connect"
| stats count, dc(dest_ip) as unique_ips, dc(dest_port) as unique_ports by src_ip
| where (unique_ips > 20 AND unique_ports > 5) OR unique_ports > 50
| risk score=60 entity=src_ip factor="Port scanning detected"
| where unique_ips > 50
| risk score=75 factor="Wide network scan"
| where unique_ports > 100
| risk score=85 factor="Extensive port enumeration"
| table timestamp, src_ip, unique_ips, unique_ports, count, risk_score, risk_factors
