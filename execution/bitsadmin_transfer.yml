---
title: bitsadmin_file_transfer
description: Detects BITSAdmin being used to download or upload files, often used as a LOLBin for payload delivery.
author: nanos.sh
severity: medium
mode: live
detection_mode: scheduled
schedule: "*/3 * * * *"
lookback: 5m
folder: endpoint
mitre_tactics:
  - TA0002
  - TA0011
mitre_techniques:
  - T1197
  - T1105
tags:
  - bitsadmin
  - lolbin
  - download
  - windows
ai_triage_hints:
  ignore_when:
    - "BITS job is from Windows Update or SCCM"
    - "Transfer is to/from known internal servers"
  suspicious_when:
    - "Transfer involves external URLs"
    - "Downloaded file is executable"
  context: "BITSAdmin creates persistent download jobs that survive reboots. Check the URL and destination path."
---
source_type=windows_sysmon OR source_type=endpoint_edr
| where action="process_create"
| where process_name="bitsadmin.exe"
| where command_line CONTAINS "/transfer" OR command_line CONTAINS "/create"
| where command_line CONTAINS "http"
| risk score=65 entity=src_host factor="BITSAdmin file transfer"
| where command_line CONTAINS ".exe" OR command_line CONTAINS ".dll"
| risk score=80 factor="Executable transfer"
| table timestamp, src_host, user, command_line, risk_score, risk_factors
