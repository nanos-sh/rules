---
title: large_upload_to_cloud_storage
description: Detects large file uploads to cloud storage services that may indicate data exfiltration.
author: nanos.sh
severity: medium
mode: live
detection_mode: scheduled
schedule: "*/10 * * * *"
lookback: 30m
folder: network
mitre_tactics:
  - TA0010
mitre_techniques:
  - T1567.002
tags:
  - cloud_storage
  - exfiltration
  - network
ai_triage_hints:
  ignore_when:
    - "User uploading to corporate-approved cloud storage"
    - "Known backup or sync process"
  suspicious_when:
    - "Upload to personal cloud storage"
    - "Large upload outside business hours"
  context: "Cloud storage is a common exfiltration channel. Check if the destination is corporate or personal."
---
source_type=proxy OR source_type=firewall
| where bytes_out > 10000000
| where url CONTAINS "dropbox.com" OR url CONTAINS "drive.google.com" OR url CONTAINS "mega.nz" OR url CONTAINS "mediafire.com" OR url CONTAINS "sendspace.com" OR url CONTAINS "wetransfer.com" OR url CONTAINS "file.io"
| eval bytes_out_mb = round(bytes_out / 1000000, 2)
| risk score=55 entity=src_host factor="Large cloud storage upload"
| where bytes_out > 50000000
| risk score=70 factor="Very large upload (>50MB)"
| where bytes_out > 200000000
| risk score=85 factor="Massive upload (>200MB)"
| table timestamp, src_host, src_ip, user, url, bytes_out_mb, risk_score, risk_factors
