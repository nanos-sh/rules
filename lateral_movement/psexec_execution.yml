---
title: psexec_remote_execution
description: Detects PsExec or similar remote execution tools creating services on target hosts.
author: nanos.sh
severity: high
mode: live
detection_mode: scheduled
schedule: "*/2 * * * *"
lookback: 5m
folder: endpoint
mitre_tactics:
  - TA0008
  - TA0002
mitre_techniques:
  - T1021.002
  - T1569.002
tags:
  - psexec
  - remote_execution
  - smb
  - windows
ai_triage_hints:
  ignore_when:
    - "IT admin using PsExec for remote management"
    - "Known deployment tool using PSEXESVC"
  suspicious_when:
    - "PsExec to sensitive server or DC"
    - "Execution of suspicious commands remotely"
  context: "PsExec enables remote command execution via SMB. While legitimate, it's heavily used by attackers for lateral movement."
---
source_type=windows_sysmon OR source_type=endpoint_edr
| where action="process_create" OR action="service_create"
| where process_name="psexec.exe" OR process_name="psexesvc.exe" OR command_line CONTAINS "PSEXESVC" OR command_line CONTAINS "\\*\admin$"
| risk score=65 entity=src_host factor="PsExec activity"
| where command_line CONTAINS "powershell" OR command_line CONTAINS "cmd /c"
| risk score=80 factor="Remote shell via PsExec"
| table timestamp, src_host, user, dest_host, command_line, risk_score, risk_factors
