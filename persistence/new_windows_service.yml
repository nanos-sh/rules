---
title: new_suspicious_windows_service
description: Detects creation of new Windows services with suspicious characteristics.
author: nanos.sh
severity: medium
mode: live
detection_mode: scheduled
schedule: "*/5 * * * *"
lookback: 15m
folder: endpoint
mitre_tactics:
  - TA0003
mitre_techniques:
  - T1543.003
tags:
  - service
  - persistence
  - windows
ai_triage_hints:
  ignore_when:
    - "Service is from known software installation"
    - "Service binary is in Program Files with valid signature"
  suspicious_when:
    - "Service binary in temp or user-writable path"
    - "Service created by cmd.exe or powershell"
  context: "Windows services run with SYSTEM privileges. Check the service binary path and who created it."
---
source_type=windows_sysmon OR source_type=windows_security
| where action="service_create" OR (process_name="sc.exe" AND command_line CONTAINS "create")
| risk score=50 entity=src_host factor="New service created"
| where command_line CONTAINS "Temp" OR command_line CONTAINS "AppData" OR command_line CONTAINS "ProgramData"
| risk score=75 factor="Suspicious binary path"
| where command_line CONTAINS "powershell" OR command_line CONTAINS "cmd /c"
| risk score=85 factor="Shell in service command"
| table timestamp, src_host, user, process_name, command_line, risk_score, risk_factors
