---
title: connection_to_newly_seen_domain
description: Detects network connections to domains that were first seen in the environment within the last 24 hours AND have low prevalence. New domains with few hosts connecting to them are strong indicators of C2 infrastructure, phishing, or malicious downloads.
author: nanos.sh
severity: high
mode: staging
detection_mode: scheduled
schedule: "*/5 * * * *"
lookback: 1h
folder: network
mitre_tactics:
  - TA0011
mitre_techniques:
  - T1071.001
  - T1102
tags:
  - prevalence
  - new_domain
  - command_control
  - network
ai_triage_hints:
  ignore_when:
    - "Domain is from a major CDN or cloud provider"
    - "Domain matches a recently onboarded SaaS application"
    - "Connection is from IT testing new services"
  suspicious_when:
    - "Domain was registered recently (check WHOIS)"
    - "Domain uses dynamic DNS provider"
    - "Connection occurs outside business hours"
    - "Large data transfer to the domain"
    - "Domain name looks like DGA (random characters)"
  context: "Newly seen domains with low prevalence are classic C2 indicators. Attackers frequently rotate domains to evade detection. Check the domain registration date, hosting provider, and SSL certificate. Look for other hosts connecting to this domain or similar domains."
---
source_type=proxy OR source_type=firewall OR source_type=dns
| where dest_host != "" AND dest_host LIKE "%.%"
| prevalence enrich=true window=30d
| where host_count < 10 AND prevalence_first_seen > now() - INTERVAL 24 HOUR
| risk score=70 entity=src_host factor="Connection to newly seen domain"
| where host_count < 5
| risk score=80 factor="Very rare domain"
| where host_count < 3
| risk score=90 factor="Extremely rare domain"
| where dest_host=/(^[a-z0-9]{12,}\.)|(\d{3,})/i
| risk score=95 factor="Possible DGA domain"
| table timestamp, src_host, src_ip, user, dest_host, dest_ip, dest_port, host_count, prevalence_first_seen, is_rare, url, risk_score, risk_factors
