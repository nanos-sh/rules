---
title: web_application_defacement
description: Detects modification of web server content files which may indicate website defacement.
author: nanos.sh
severity: high
mode: live
detection_mode: scheduled
schedule: "*/3 * * * *"
lookback: 10m
folder: endpoint
mitre_tactics:
  - TA0040
mitre_techniques:
  - T1491.002
tags:
  - defacement
  - web
  - impact
ai_triage_hints:
  ignore_when:
    - "Authorized web deployment"
    - "CI/CD pipeline deploying updates"
  suspicious_when:
    - "Web files modified by non-deployment process"
    - "index.html modified outside deployment window"
  context: "Web defacement damages brand reputation. Check if the modification was authorized and review the changed content."
---
source_type=endpoint_edr OR source_type=windows_sysmon
| where file_action="modify"
| where file_path CONTAINS "wwwroot" OR file_path CONTAINS "htdocs" OR file_path CONTAINS "public_html" OR file_path CONTAINS "nginx/html"
| where file_path CONTAINS "index.htm" OR file_path CONTAINS "default.asp" OR file_path CONTAINS "index.php"
| where process_name NOT IN ("w3wp.exe", "httpd", "nginx", "apache2", "java")
| risk score=75 entity=src_host factor="Web content modified"
| where process_name IN ("cmd.exe", "powershell.exe", "bash")
| risk score=90 factor="Shell modified web content"
| table timestamp, src_host, user, process_name, file_path, risk_score, risk_factors
