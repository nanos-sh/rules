---
title: oauth_consent_phishing
description: Detects OAuth application consent grants from suspicious or newly registered applications.
author: nanos.sh
severity: high
mode: live
detection_mode: scheduled
schedule: "*/5 * * * *"
lookback: 15m
folder: identity
mitre_tactics:
  - TA0001
mitre_techniques:
  - T1566.002
  - T1550.001
tags:
  - oauth
  - consent
  - phishing
  - cloud
ai_triage_hints:
  ignore_when:
    - "Known enterprise application"
    - "IT-approved OAuth consent"
  suspicious_when:
    - "Application requests excessive permissions"
    - "Application registered recently"
  context: "OAuth consent phishing tricks users into granting access to malicious apps. Check the app permissions and publisher."
---
source_type=azure_ad OR source_type=okta
| where action="consent_grant" OR action="app_authorize"
| risk score=55 entity=user factor="OAuth consent granted"
| where message CONTAINS "Mail.Read" OR message CONTAINS "Files.ReadWrite" OR message CONTAINS "User.Read.All"
| risk score=75 factor="Sensitive permissions granted"
| where message CONTAINS "Application" AND message NOT CONTAINS "verified"
| risk score=85 factor="Unverified application"
| table timestamp, user, src_ip, message, risk_score, risk_factors
