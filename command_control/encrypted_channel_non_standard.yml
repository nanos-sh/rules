---
title: encrypted_traffic_non_standard_port
description: Detects TLS/SSL traffic on non-standard ports which may indicate covert C2 channels.
author: nanos.sh
severity: medium
mode: live
detection_mode: scheduled
schedule: "*/10 * * * *"
lookback: 30m
folder: network
mitre_tactics:
  - TA0011
mitre_techniques:
  - T1573.002
tags:
  - encrypted
  - non_standard_port
  - c2
  - network
ai_triage_hints:
  ignore_when:
    - "Known application using non-standard TLS port"
    - "Internal service on custom port"
  suspicious_when:
    - "TLS to external IP on high port"
    - "Connection to low-prevalence IP"
  context: "TLS on non-standard ports can hide C2. Standard ports (443, 8443) are expected; unusual ports warrant investigation."
---
source_type=firewall OR source_type=network_flow
| where protocol="tls" OR protocol="ssl"
| where dest_port NOT IN (443, 8443, 993, 995, 636, 989, 990)
| where dest_ip!=/^(10\.|192\.168\.|172\.(1[6-9]|2[0-9]|3[01])\.)/
| risk score=50 entity=src_host factor="TLS on non-standard port"
| prevalence enrich=true window=30d
| where host_count < 5
| risk score=70 factor="Rare TLS destination"
| where host_count < 2
| risk score=85 factor="Unique encrypted channel"
| table timestamp, src_host, src_ip, dest_ip, dest_port, host_count, risk_score, risk_factors
