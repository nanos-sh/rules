---
title: unauthorized_remote_access_tool
description: Detects execution of remote access tools not approved by the organization.
author: nanos.sh
severity: medium
mode: live
detection_mode: scheduled
schedule: "*/5 * * * *"
lookback: 15m
folder: endpoint
mitre_tactics:
  - TA0011
mitre_techniques:
  - T1219
tags:
  - rat
  - remote_access
  - c2
ai_triage_hints:
  ignore_when:
    - "IT help desk using approved remote tool"
    - "User-installed remote support for vendor assistance"
  suspicious_when:
    - "RAT installed silently without user interaction"
    - "Multiple remote tools on same host"
  context: "Remote access tools provide full control of the endpoint. Verify the tool is authorized and the connection is legitimate."
---
source_type=endpoint_edr OR source_type=windows_sysmon
| where action="process_create"
| where process_name IN ("AnyDesk.exe", "TeamViewer.exe", "ScreenConnect.exe", "RemoteDesktop.exe", "ammyy.exe", "RustDesk.exe", "meshagent.exe") OR command_line CONTAINS "connectwise" OR command_line CONTAINS "splashtop"
| risk score=50 entity=src_host factor="Remote access tool detected"
| where process_path CONTAINS "Temp" OR process_path CONTAINS "AppData"
| risk score=75 factor="RAT from suspicious path"
| table timestamp, src_host, user, process_name, process_path, command_line, risk_score, risk_factors
