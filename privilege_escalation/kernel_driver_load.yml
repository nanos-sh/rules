---
title: unsigned_kernel_driver_load
description: Detects loading of unsigned or rarely seen kernel drivers which may indicate privilege escalation or rootkit installation.
author: nanos.sh
severity: critical
mode: live
detection_mode: scheduled
schedule: "*/2 * * * *"
lookback: 5m
folder: endpoint
mitre_tactics:
  - TA0004
mitre_techniques:
  - T1068
tags:
  - driver
  - kernel
  - rootkit
  - windows
ai_triage_hints:
  ignore_when:
    - "Driver is from known hardware vendor update"
    - "Driver is signed by Microsoft or WHQL"
  suspicious_when:
    - "Driver has no digital signature"
    - "Driver loaded from temp or user directory"
  context: "Kernel drivers run with highest privileges. Unsigned or rare drivers may be rootkits or BYOVD attacks."
---
source_type=windows_sysmon OR source_type=endpoint_edr
| where action="driver_load"
| prevalence enrich=true window=30d
| where host_count < 10
| risk score=70 entity=src_host factor="Rare kernel driver"
| where host_count < 3
| risk score=90 factor="Very rare driver"
| where file_path CONTAINS "Temp" OR file_path CONTAINS "AppData" OR file_path CONTAINS "Downloads"
| risk score=95 factor="Driver from suspicious path"
| table timestamp, src_host, file_path, file_hash, host_count, risk_score, risk_factors
