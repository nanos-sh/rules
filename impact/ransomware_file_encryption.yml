---
title: ransomware_file_encryption_pattern
description: Detects rapid file modification and renaming patterns consistent with ransomware encryption.
author: nanos.sh
severity: critical
mode: live
detection_mode: scheduled
schedule: "*/1 * * * *"
lookback: 5m
folder: endpoint
mitre_tactics:
  - TA0040
mitre_techniques:
  - T1486
tags:
  - ransomware
  - encryption
  - critical
ai_triage_hints:
  ignore_when:
    - "Known encryption or compression tool"
    - "Legitimate bulk file rename operation"
  suspicious_when:
    - "Many files renamed with new extensions rapidly"
    - "Ransom note files created"
  context: "CRITICAL: Active ransomware encryption. Isolate the host immediately. Check for backup integrity and notify IR team."
---
source_type=endpoint_edr OR source_type=windows_sysmon
| where file_action="rename" OR file_action="modify"
| where file_path=/(\.encrypted|\.locked|\.crypto|\.crypt|\.enc|\.pay|\.ransom)$/i
| stats count by src_host, process_name
| where count > 10
| risk score=95 entity=src_host factor="Ransomware encryption pattern"
| where count > 100
| risk score=99 factor="Active ransomware encryption"
| table timestamp, src_host, user, process_name, count, risk_score, risk_factors
