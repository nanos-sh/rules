---
title: vpn_brute_force_attempt
description: Detects brute force attacks against VPN endpoints from a single source.
author: nanos.sh
severity: high
mode: live
detection_mode: scheduled
schedule: "*/5 * * * *"
lookback: 15m
folder: network
mitre_tactics:
  - TA0001
mitre_techniques:
  - T1110
tags:
  - vpn
  - brute_force
  - perimeter
ai_triage_hints:
  ignore_when:
    - "User with connectivity issues"
    - "Known vulnerability scanner"
  suspicious_when:
    - "Many failures from single IP"
    - "Targeting multiple accounts"
  context: "VPN brute force provides remote access to the internal network. Block the source IP and check for successful auth."
---
source_type=vpn_logs OR source_type=firewall OR source_type=auth_logs
| where action="login" AND status="failure"
| where source_type CONTAINS "vpn" OR message CONTAINS "VPN" OR dest_port IN (443, 1194, 500, 4500)
| stats count, dc(user) as unique_users by src_ip
| where count > 20
| risk score=65 entity=src_ip factor="VPN brute force"
| where unique_users > 5
| risk score=80 factor="Multi-user VPN brute force"
| where unique_users > 20
| risk score=90 factor="Large-scale VPN attack"
| table timestamp, src_ip, count, unique_users, risk_score, risk_factors
