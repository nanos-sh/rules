---
title: dcsync_replication_attack
description: Detects DCSync attacks where a non-DC host requests directory replication, used to extract password hashes.
author: nanos.sh
severity: critical
mode: live
detection_mode: scheduled
schedule: "*/1 * * * *"
lookback: 5m
folder: identity
mitre_tactics:
  - TA0006
mitre_techniques:
  - T1003.006
tags:
  - dcsync
  - active_directory
  - mimikatz
ai_triage_hints:
  ignore_when:
    - "Source is a known domain controller"
    - "Azure AD Connect server performing sync"
  suspicious_when:
    - "Replication request from workstation"
    - "Non-DC requesting GetNCChanges"
  context: "DCSync allows extraction of all domain password hashes. This is a critical attack that provides complete domain compromise."
---
source_type=windows_security
| where action="directory_replication" OR message CONTAINS "GetNCChanges" OR message CONTAINS "DsGetNCChanges"
| where src_host NOT CONTAINS "dc" AND src_host NOT CONTAINS "domain"
| risk score=95 entity=src_host factor="DCSync from non-DC"
| table timestamp, src_host, src_ip, user, dest_host, risk_score, risk_factors
