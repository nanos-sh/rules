---
title: network_share_enumeration
description: Detects enumeration of network shares across multiple hosts.
author: nanos.sh
severity: medium
mode: live
detection_mode: scheduled
schedule: "*/5 * * * *"
lookback: 15m
folder: endpoint
mitre_tactics:
  - TA0007
mitre_techniques:
  - T1135
tags:
  - network_shares
  - smb
  - windows
ai_triage_hints:
  ignore_when:
    - "IT admin auditing share permissions"
    - "Backup software discovering shares"
  suspicious_when:
    - "Enumerating shares on many hosts rapidly"
    - "Non-admin user discovering shares"
  context: "Share enumeration finds file repositories for data collection. Check if sensitive shares were accessed after discovery."
---
source_type=windows_sysmon OR source_type=endpoint_edr
| where action="process_create"
| where (process_name="net.exe" AND command_line CONTAINS "view") OR (process_name="net.exe" AND command_line CONTAINS "share") OR command_line CONTAINS "Get-SmbShare"
| risk score=40 entity=src_host factor="Share enumeration"
| where command_line CONTAINS "\\*" OR command_line CONTAINS "/domain"
| risk score=65 factor="Domain-wide share enumeration"
| table timestamp, src_host, user, command_line, risk_score, risk_factors
