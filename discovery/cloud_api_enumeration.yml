---
title: cloud_api_excessive_enumeration
description: Detects excessive cloud API calls for listing and describing resources, indicative of cloud reconnaissance.
author: nanos.sh
severity: medium
mode: live
detection_mode: scheduled
schedule: "*/5 * * * *"
lookback: 15m
folder: cloud
mitre_tactics:
  - TA0007
mitre_techniques:
  - T1580
  - T1526
tags:
  - cloud
  - aws
  - azure
  - enumeration
ai_triage_hints:
  ignore_when:
    - "Known cloud management or inventory tool"
    - "Cloud security posture management (CSPM) tool"
  suspicious_when:
    - "Many list/describe calls from new identity"
    - "Calls span multiple services"
  context: "Cloud enumeration maps the attack surface. Check if the identity is authorized and if credentials may be compromised."
---
source_type=cloudtrail OR source_type=azure_activity
| where action=/(List|Describe|Get)/i
| stats count, dc(message) as unique_apis, min(timestamp) as timestamp by user, src_ip
| where count > 50 AND unique_apis > 10
| risk score=55 entity=user factor="Cloud API enumeration"
| where unique_apis > 30
| risk score=75 factor="Extensive cloud recon"
| table timestamp, user, src_ip, count, unique_apis, risk_score, risk_factors
