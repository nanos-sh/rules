---
title: mass_file_deletion_evidence_removal
description: Detects mass deletion of files that may indicate evidence destruction or ransomware pre-encryption behavior.
author: nanos.sh
severity: medium
mode: live
detection_mode: scheduled
schedule: "*/5 * * * *"
lookback: 10m
folder: endpoint
mitre_tactics:
  - TA0005
mitre_techniques:
  - T1070.004
tags:
  - file_deletion
  - anti_forensics
  - windows
ai_triage_hints:
  ignore_when:
    - "Scheduled cleanup or disk space maintenance"
    - "Temp file cleanup by legitimate process"
  suspicious_when:
    - "Deleting files with security tool extensions (.evtx, .log)"
    - "Mass deletion followed by other suspicious activity"
  context: "Mass file deletion can be evidence destruction or ransomware prep. Check what files were deleted and by which process."
---
source_type=windows_sysmon OR source_type=endpoint_edr
| where file_action="delete"
| where file_path CONTAINS ".evtx" OR file_path CONTAINS ".log" OR file_path CONTAINS ".pcap" OR file_path CONTAINS "Prefetch"
| risk score=70 entity=src_host factor="Forensic artifact deletion"
| where process_name IN ("cmd.exe", "powershell.exe") AND command_line CONTAINS "del"
| risk score=80 factor="Shell-based file deletion"
| table timestamp, src_host, user, process_name, file_path, command_line, risk_score, risk_factors
