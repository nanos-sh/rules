---
title: password_spray_attack
description: Detects password spray attacks where one password is tried against many accounts.
author: nanos.sh
severity: high
mode: live
detection_mode: scheduled
schedule: "*/3 * * * *"
lookback: 15m
folder: identity
mitre_tactics:
  - TA0006
mitre_techniques:
  - T1110.003
tags:
  - password_spray
  - brute_force
  - authentication
ai_triage_hints:
  ignore_when:
    - "Failed logins from known vulnerability scanner"
    - "Service account with expired credentials"
  suspicious_when:
    - "Failures across many different accounts from same source"
    - "Attempts during off-hours"
  context: "Password spraying tries common passwords against many accounts to avoid lockout. Check if any accounts were compromised."
---
source_type=auth_logs OR source_type=okta OR source_type=azure_ad
| where action="login" AND status="failure"
| stats count, dc(user) as unique_users, min(timestamp) as timestamp by src_ip
| where count > 20 AND unique_users > 10
| risk score=75 entity=src_ip factor="Password spray detected"
| where unique_users > 50
| risk score=90 factor="Large-scale spray"
| table timestamp, src_ip, count, unique_users, risk_score, risk_factors
