---
title: credential_search_in_files
description: Detects searching for credentials in files using findstr, grep, or similar tools.
author: nanos.sh
severity: medium
mode: live
detection_mode: scheduled
schedule: "*/5 * * * *"
lookback: 15m
folder: endpoint
mitre_tactics:
  - TA0006
mitre_techniques:
  - T1552.001
tags:
  - credential_search
  - files
  - cross_platform
ai_triage_hints:
  ignore_when:
    - "Developer searching their own code"
    - "Security audit tool scanning for exposed credentials"
  suspicious_when:
    - "Search includes password, secret, key patterns"
    - "Search targets configuration files"
  context: "Attackers search for hardcoded credentials in config files and scripts. Check if any credentials were found and exposed."
---
source_type=windows_sysmon OR source_type=endpoint_edr
| where action="process_create"
| where process_name IN ("findstr.exe", "find.exe", "select-string", "grep")
| where command_line CONTAINS "password" OR command_line CONTAINS "secret" OR command_line CONTAINS "credential" OR command_line CONTAINS "api_key" OR command_line CONTAINS "token"
| risk score=50 entity=src_host factor="Credential search in files"
| where command_line CONTAINS "/s" OR command_line CONTAINS "-r"
| risk score=70 factor="Recursive credential search"
| table timestamp, src_host, user, process_name, command_line, risk_score, risk_factors
