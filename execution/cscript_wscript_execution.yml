---
title: cscript_wscript_suspicious_execution
description: Detects cscript/wscript executing scripts from suspicious locations or with suspicious arguments.
author: nanos.sh
severity: medium
mode: live
detection_mode: scheduled
schedule: "*/3 * * * *"
lookback: 5m
folder: endpoint
mitre_tactics:
  - TA0002
mitre_techniques:
  - T1059.005
  - T1059.007
tags:
  - wscript
  - cscript
  - scripting
  - windows
ai_triage_hints:
  ignore_when:
    - "Script is a known login or GPO script"
    - "Script path is in a managed deployment folder"
  suspicious_when:
    - "Script executed from Temp or user profile"
    - "Script has obfuscated name or random characters"
  context: "WSH scripts (VBS/JS) are common initial execution vectors from phishing. Check the script content and what spawned it."
---
source_type=windows_sysmon OR source_type=endpoint_edr
| where action="process_create"
| where process_name IN ("cscript.exe", "wscript.exe")
| where command_line CONTAINS "Temp" OR command_line CONTAINS "AppData" OR command_line CONTAINS "Downloads"
| risk score=55 entity=src_host factor="Script from suspicious path"
| where parent_process IN ("winword.exe", "excel.exe", "outlook.exe", "powerpnt.exe")
| risk score=85 factor="Office parent process"
| where command_line CONTAINS "//E:jscript" OR command_line CONTAINS "//E:vbscript"
| risk score=70 factor="Explicit script engine"
| table timestamp, src_host, user, process_name, parent_process, command_line, risk_score, risk_factors
