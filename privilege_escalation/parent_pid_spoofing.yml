---
title: parent_pid_spoofing_detection
description: Detects processes where the parent PID has been spoofed to appear as a different process.
author: nanos.sh
severity: high
mode: live
detection_mode: scheduled
schedule: "*/3 * * * *"
lookback: 10m
folder: endpoint
mitre_tactics:
  - TA0004
  - TA0005
mitre_techniques:
  - T1134.004
tags:
  - ppid_spoofing
  - evasion
  - windows
ai_triage_hints:
  ignore_when:
    - "Process is launched by a known container or sandbox"
  suspicious_when:
    - "Child process doesn't match expected parent"
    - "svchost.exe with unusual parent"
  context: "PPID spoofing is used to evade detections that rely on parent-child relationships. The true parent is hidden."
---
source_type=windows_sysmon OR source_type=endpoint_edr
| where action="process_create"
| where process_name="svchost.exe" AND parent_process NOT IN ("services.exe", "MsMpEng.exe")
| risk score=80 entity=src_host factor="svchost unusual parent"
| table timestamp, src_host, user, process_name, parent_process, command_line, risk_score, risk_factors
