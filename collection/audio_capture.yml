---
title: audio_recording_detection
description: Detects processes accessing audio recording capabilities, potentially for surveillance.
author: nanos.sh
severity: medium
mode: live
detection_mode: scheduled
schedule: "*/10 * * * *"
lookback: 30m
folder: endpoint
mitre_tactics:
  - TA0009
mitre_techniques:
  - T1123
tags:
  - audio
  - surveillance
  - collection
ai_triage_hints:
  ignore_when:
    - "Known conferencing app (Teams, Zoom, Webex)"
    - "Audio editing or recording application"
  suspicious_when:
    - "Unknown process accessing microphone"
    - "Audio capture by scripting engine"
  context: "Audio capture enables eavesdropping on conversations. Verify the capturing process is legitimate."
---
source_type=endpoint_edr
| where action="device_access" OR action="api_call"
| where command_line CONTAINS "AudioRecord" OR command_line CONTAINS "microphone" OR command_line CONTAINS "waveIn" OR command_line CONTAINS "SoundRecorder"
| where process_name NOT IN ("teams.exe", "zoom.exe", "webex.exe", "slack.exe", "chrome.exe", "msedge.exe")
| prevalence enrich=true window=30d
| where host_count < 10
| risk score=60 entity=src_host factor="Audio capture detected"
| where host_count < 3
| risk score=85 factor="Rare audio capture process"
| table timestamp, src_host, user, process_name, process_hash, host_count, risk_score, risk_factors
