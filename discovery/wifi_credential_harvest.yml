---
title: wifi_credential_harvesting
description: Detects extraction of saved WiFi passwords using netsh wlan commands.
author: nanos.sh
severity: medium
mode: live
detection_mode: scheduled
schedule: "*/10 * * * *"
lookback: 30m
folder: endpoint
mitre_tactics:
  - TA0007
  - TA0006
mitre_techniques:
  - T1040
  - T1552
tags:
  - wifi
  - credentials
  - windows
ai_triage_hints:
  ignore_when:
    - "IT admin managing WiFi profiles"
  suspicious_when:
    - "Profile key extraction (show profile key=clear)"
    - "All profiles dumped at once"
  context: "WiFi passwords can be used for physical access or credential reuse attacks."
---
source_type=windows_sysmon OR source_type=endpoint_edr
| where action="process_create"
| where process_name="netsh.exe" AND command_line CONTAINS "wlan" AND command_line CONTAINS "show" AND command_line CONTAINS "profile"
| where command_line CONTAINS "key=clear"
| risk score=65 entity=src_host factor="WiFi credential harvesting"
| table timestamp, src_host, user, command_line, risk_score, risk_factors
