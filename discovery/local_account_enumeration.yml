---
title: local_account_enumeration
description: Detects enumeration of local accounts and groups using net commands.
author: nanos.sh
severity: low
mode: live
detection_mode: scheduled
schedule: "*/10 * * * *"
lookback: 30m
folder: endpoint
mitre_tactics:
  - TA0007
mitre_techniques:
  - T1087.001
tags:
  - account_enumeration
  - windows
ai_triage_hints:
  ignore_when:
    - "IT admin performing user management"
    - "Automated inventory script"
  suspicious_when:
    - "Multiple enumeration commands in sequence"
    - "Performed by non-admin user"
  context: "Account enumeration reveals who has access. Combined with other recon, it maps potential targets for privilege escalation."
---
source_type=windows_sysmon OR source_type=endpoint_edr
| where action="process_create"
| where process_name="net.exe" OR process_name="net1.exe"
| where command_line CONTAINS "user" OR command_line CONTAINS "localgroup" OR command_line CONTAINS "group"
| where command_line NOT CONTAINS "/add" AND command_line NOT CONTAINS "/delete"
| risk score=35 entity=src_host factor="Account enumeration"
| where command_line CONTAINS "domain"
| risk score=55 factor="Domain account enumeration"
| table timestamp, src_host, user, command_line, risk_score, risk_factors
