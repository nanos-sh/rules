---
title: unexpected_python_execution
description: Detects Python interpreter execution on hosts where Python is not typically used, potentially indicating attacker tooling.
author: nanos.sh
severity: medium
mode: live
detection_mode: scheduled
schedule: "*/5 * * * *"
lookback: 10m
folder: endpoint
mitre_tactics:
  - TA0002
mitre_techniques:
  - T1059.006
tags:
  - python
  - scripting
  - cross_platform
ai_triage_hints:
  ignore_when:
    - "Host is a developer workstation"
    - "Python is used by known automation tools"
  suspicious_when:
    - "Python runs encoded or obfuscated script"
    - "Python makes network connections after launch"
  context: "Python on non-developer hosts often indicates attacker tooling. Check what script was executed and who installed Python."
---
source_type=endpoint_edr OR source_type=windows_sysmon
| where action="process_create"
| where process_name="python.exe" OR process_name="python3.exe" OR process_name="pythonw.exe" OR process_name="python3"
| prevalence enrich=true window=30d
| where host_count < 20
| risk score=50 entity=src_host factor="Uncommon Python execution"
| where command_line CONTAINS "-c" AND (command_line CONTAINS "import socket" OR command_line CONTAINS "import subprocess" OR command_line CONTAINS "exec(")
| risk score=85 factor="Suspicious Python one-liner"
| table timestamp, src_host, user, process_name, command_line, host_count, risk_score, risk_factors
