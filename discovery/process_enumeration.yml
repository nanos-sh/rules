---
title: process_listing_for_security_tools
description: Detects process listing commands specifically looking for security tools and defensive software.
author: nanos.sh
severity: low
mode: live
detection_mode: scheduled
schedule: "*/10 * * * *"
lookback: 30m
folder: endpoint
mitre_tactics:
  - TA0007
mitre_techniques:
  - T1057
tags:
  - process_discovery
  - defense_recon
  - windows
ai_triage_hints:
  ignore_when:
    - "Monitoring tool checking process health"
    - "IT admin troubleshooting"
  suspicious_when:
    - "Filtering for AV/EDR process names"
    - "Combined with other reconnaissance"
  context: "Listing processes to find security tools helps attackers plan evasion strategies."
---
source_type=windows_sysmon OR source_type=endpoint_edr
| where action="process_create"
| where (process_name="tasklist.exe" OR process_name="wmic.exe") AND command_line CONTAINS "process"
| where command_line CONTAINS "MsMpEng" OR command_line CONTAINS "Carbon" OR command_line CONTAINS "Crowd" OR command_line CONTAINS "Sentinel" OR command_line CONTAINS "Cylance"
| risk score=55 entity=src_host factor="Security process discovery"
| table timestamp, src_host, user, command_line, risk_score, risk_factors
