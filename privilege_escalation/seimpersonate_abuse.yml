---
title: seimpersonate_privilege_abuse
description: Detects abuse of SeImpersonatePrivilege commonly exploited by Potato-family exploits on Windows.
author: nanos.sh
severity: high
mode: live
detection_mode: scheduled
schedule: "*/3 * * * *"
lookback: 10m
folder: endpoint
mitre_tactics:
  - TA0004
mitre_techniques:
  - T1134.001
tags:
  - potato
  - impersonation
  - windows
ai_triage_hints:
  ignore_when:
    - "IIS or SQL Server performing normal impersonation"
    - "Known service account behavior"
  suspicious_when:
    - "Service account spawning interactive shell"
    - "SYSTEM shell from web or database service"
  context: "Service accounts with SeImpersonate can be escalated to SYSTEM via Potato exploits. Check for unusual child processes."
---
source_type=windows_sysmon OR source_type=endpoint_edr
| where action="process_create"
| where parent_process IN ("w3wp.exe", "sqlservr.exe", "mssql.exe", "tomcat.exe")
| where process_name IN ("cmd.exe", "powershell.exe", "whoami.exe", "net.exe")
| risk score=80 entity=src_host factor="Service account spawning shell"
| where user CONTAINS "SYSTEM" OR user CONTAINS "NT AUTHORITY"
| risk score=95 factor="SYSTEM shell from service"
| table timestamp, src_host, user, parent_process, process_name, command_line, risk_score, risk_factors
