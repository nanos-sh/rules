---
title: screen_capture_activity
description: Detects screen capture utilities or screenshot APIs being used by unexpected processes.
author: nanos.sh
severity: medium
mode: live
detection_mode: scheduled
schedule: "*/10 * * * *"
lookback: 30m
folder: endpoint
mitre_tactics:
  - TA0009
mitre_techniques:
  - T1113
tags:
  - screenshot
  - collection
  - cross_platform
ai_triage_hints:
  ignore_when:
    - "Known screenshot or collaboration tool"
    - "Snipping tool or Greenshot"
  suspicious_when:
    - "Unknown process taking screenshots"
    - "Repeated screenshot activity"
  context: "Screen capture can expose sensitive information displayed on screen. Check the capturing process."
---
source_type=endpoint_edr OR source_type=windows_sysmon
| where action="process_create"
| where command_line CONTAINS "screenshot" OR command_line CONTAINS "CopyFromScreen" OR command_line CONTAINS "BitBlt" OR command_line CONTAINS "[System.Windows.Forms.Screen]"
| prevalence enrich=true window=30d
| where host_count < 10
| risk score=50 entity=src_host factor="Screen capture activity"
| where host_count < 3
| risk score=80 factor="Rare screenshot process"
| table timestamp, src_host, user, process_name, process_hash, host_count, risk_score, risk_factors
