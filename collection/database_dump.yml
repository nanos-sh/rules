---
title: database_credential_dump
description: Detects database export utilities that may indicate data collection for exfiltration.
author: nanos.sh
severity: high
mode: live
detection_mode: scheduled
schedule: "*/5 * * * *"
lookback: 15m
folder: endpoint
mitre_tactics:
  - TA0009
mitre_techniques:
  - T1005
tags:
  - database
  - collection
  - cross_platform
ai_triage_hints:
  ignore_when:
    - "Scheduled backup process"
    - "DBA performing authorized export"
  suspicious_when:
    - "Database dump to non-standard location"
    - "Export by non-DBA user"
  context: "Database dumps can contain massive amounts of sensitive data. Verify authorization and check where the dump was sent."
---
source_type=endpoint_edr OR source_type=windows_sysmon
| where action="process_create"
| where process_name IN ("mysqldump", "pg_dump", "sqlcmd.exe", "bcp.exe", "mongodump")
| risk score=50 entity=src_host factor="Database dump detected"
| where command_line CONTAINS "Temp" OR command_line CONTAINS "Downloads" OR command_line CONTAINS "/tmp"
| risk score=75 factor="Dump to suspicious path"
| table timestamp, src_host, user, process_name, command_line, risk_score, risk_factors
