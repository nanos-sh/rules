---
title: cobalt_strike_indicators
description: Detects indicators of Cobalt Strike beacon activity including named pipes, malleable C2 patterns, and known defaults.
author: nanos.sh
severity: critical
mode: live
detection_mode: scheduled
schedule: "*/2 * * * *"
lookback: 5m
folder: endpoint
mitre_tactics:
  - TA0011
mitre_techniques:
  - T1071.001
  - T1095
tags:
  - cobalt_strike
  - c2
  - windows
ai_triage_hints:
  ignore_when:
    - "Authorized red team exercise with known timeframe"
  suspicious_when:
    - "Default Cobalt Strike named pipe patterns"
    - "Known CS beacon sleep patterns"
  context: "Cobalt Strike is the most common adversary C2 framework. Detection indicates active hands-on-keyboard intrusion."
---
source_type=windows_sysmon OR source_type=endpoint_edr
| where action="pipe_create" OR action="process_create"
| where command_line CONTAINS "\MSSE-" OR command_line CONTAINS "\postex_" OR command_line CONTAINS "\status_" OR command_line CONTAINS "\msagent_" OR command_line CONTAINS "\postex_ssh_"
| risk score=90 entity=src_host factor="Cobalt Strike indicators"
| where command_line CONTAINS "\MSSE-" AND command_line CONTAINS "\pipe\"
| risk score=95 factor="Default CS named pipe"
| table timestamp, src_host, user, process_name, command_line, risk_score, risk_factors
