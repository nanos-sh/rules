---
title: browser_exploitation_indicators
description: Detects browser processes spawning suspicious child processes that may indicate drive-by compromise.
author: nanos.sh
severity: high
mode: live
detection_mode: scheduled
schedule: "*/2 * * * *"
lookback: 5m
folder: endpoint
mitre_tactics:
  - TA0001
  - TA0002
mitre_techniques:
  - T1189
tags:
  - drive_by
  - browser
  - exploit
ai_triage_hints:
  ignore_when:
    - "Browser extension or plugin"
    - "Known browser helper process"
  suspicious_when:
    - "Browser spawns cmd, powershell, or wscript"
    - "Browser creates executable files"
  context: "Drive-by compromise exploits browser vulnerabilities. If a browser spawns shells, assume exploitation occurred."
---
source_type=endpoint_edr OR source_type=windows_sysmon
| where action="process_create"
| where parent_process IN ("chrome.exe", "firefox.exe", "msedge.exe", "iexplore.exe", "brave.exe")
| where process_name IN ("cmd.exe", "powershell.exe", "wscript.exe", "cscript.exe", "rundll32.exe", "regsvr32.exe", "mshta.exe")
| risk score=85 entity=src_host factor="Browser spawned shell"
| where process_name="powershell.exe" AND command_line CONTAINS "-enc"
| risk score=95 factor="Browser spawned encoded PowerShell"
| table timestamp, src_host, user, parent_process, process_name, command_line, risk_score, risk_factors
