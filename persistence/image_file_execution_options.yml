---
title: image_file_execution_options_debugger
description: Detects setting of Image File Execution Options debugger keys, used to hijack process execution.
author: nanos.sh
severity: high
mode: live
detection_mode: scheduled
schedule: "*/5 * * * *"
lookback: 10m
folder: endpoint
mitre_tactics:
  - TA0003
  - TA0004
mitre_techniques:
  - T1546.012
tags:
  - ifeo
  - registry
  - persistence
  - windows
ai_triage_hints:
  ignore_when:
    - "Debugger is a known development tool (Visual Studio, WinDbg)"
    - "Set by IT for application compatibility"
  suspicious_when:
    - "Debugger points to cmd.exe or powershell.exe"
    - "Target is accessibility tool (sethc.exe, utilman.exe)"
  context: "IFEO debugger keys redirect process execution. Targeting accessibility tools creates a backdoor at the login screen."
---
source_type=windows_sysmon
| where action="registry_set"
| where registry_key CONTAINS "Image File Execution Options" AND registry_key CONTAINS "Debugger"
| risk score=75 entity=src_host factor="IFEO debugger set"
| where registry_key CONTAINS "sethc.exe" OR registry_key CONTAINS "utilman.exe" OR registry_key CONTAINS "osk.exe" OR registry_key CONTAINS "narrator.exe"
| risk score=95 factor="Accessibility tool hijack"
| table timestamp, src_host, user, registry_key, registry_value, process_name, risk_score, risk_factors
